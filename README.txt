==========
Members: 
==========
1. Akhilesh Gadde (109836849)
2. Vamsi Krishna Atluri	(109597320) 
3. Sai Santhosh Vaidyam Anandan (109819365)
4. Datt Goswami (109597782)

==============
List of Files
==============

- mod_firewall.c -> Source code for the protection module.
- mod_firewall.h -> Helper functions for the mod_firewall.c
- mod_waf.c -> Source Code for the Learning phase module.
- mod_waf.h -> Helper functions for the protection phase module.
- mydatastructures.h -> Helper functions for the modules
- rules_check.h -> Helper function to check the rules. Used by both the modules.
- common.h -> Configuration file containing the paths for Log_file, General_Rules_File and Learner_dir
- learner.py -> python file to generate the rules.
- html -> Directory containing all the web pages used in the project.
- mylog.txt -> Sample Log file generated by mod_waf (Learning Phase).
- log_learner -> Sample Rules Directory (generated by learner.py).
- general.txt -> Sample file containing general rules.

===========
Deployment
===========

Requirements:
	- apache2 server
	- apache2-dev (APXS)
	- php5
	- python 2.7.6
	
==============
Initial Setup
==============

- Open common.h file from the source files and edit the paths as per your configuration.

- Use the following commands to compile both the modules. 

		sudo apxs -i -c -a mod_waf.c
		sudo apxs -i -c -a mod_firewall.c
		
- APXS utility will compile the modules and install them.

- Create file: "/etc/apache2/mods-available/waf.conf" with the following text:

	<Location "/"> 
	SetHandler waf_handler
	</Location>

- Create file : "/etc/apache2/mods-available/firewall.conf" with the following text:

	<Location "/"> 
	SetHandler firewall_handler
	</Location>
	
- Open: "/etc/apache2/envvars" and change the APACHE_RUN_USER and APACHE_RUN_GROUP to the current username.
- Also create the general rules file and set its path in the commom.h file for the parameter GENERAL_RULES_FILE.

===============
Training Phase
===============

- Enable the waf module to start the learning phase using the following command:
	sudo a2enmod waf
- Restart the apache server
	sudo service apache2 restart
- The training Phase initialization will be completed.
- The log file will be generated in the path given in LOG_FILE parameter in
	common.h
		
=================
Rules Generation
=================

- Go to the directory where the log file is located, and execute the following command to generate the rules:
	python learner.py
- On success, "File Parsed" is displayed.
- Set the path of obtained "log_learner" directory in common.h for the LEARNER_DIR parameter.
- This concludes the rules generation phase.

=================
Protection Phase
=================

- Disable the waf module (learning phase module) using the command:
	sudo a2dismod waf
- Enable the Firewall module using the command :
	sudo a2enmod firewall
- Restart the apache server
	sudo service apache2 restart
- Now the protection phase is enabled and will block requests based on the rules defined in log_learner directory.

